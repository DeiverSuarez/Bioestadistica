---
title: "Estad√≠stica Descriptiva"
number-depth: 2
format:
  html:
    toc: true
    toc-depth: 2
    number-sections: true
    theme: cosmo
    code-fold: true
    code-summary: "Ver c√≥digo"
    code-overflow: wrap
    html-math-method: mathjax
    lang: es
    fenced-divs: true
---

```{r}
#| echo: false
# Establecer opciones globales de chunk
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Introducci√≥n

La estad√≠stica descriptiva constituye el primer paso esencial en el an√°lisis de datos, ya que permite organizar, resumir y visualizar la informaci√≥n de manera clara y comprensible. A trav√©s de ella, es posible identificar patrones, detectar anomal√≠as y formular hip√≥tesis preliminares antes de aplicar m√©todos m√°s complejos de inferencia o modelado predictivo.

Como se√±alan Spriestersbach y colaboradores (2009), la presentaci√≥n adecuada de los datos no solo facilita su comprensi√≥n, sino que tambi√©n revela si fueron recolectados y analizados de forma rigurosa. Esta etapa cobra especial relevancia en el contexto de investigaciones biom√©dicas, donde cada observaci√≥n ‚Äîya sea un paciente, una c√©lula o un evento cl√≠nico‚Äî representa una unidad estad√≠stica con m√∫ltiples variables asociadas, tanto cuantitativas como cualitativas.

Este libro propone una aproximaci√≥n aplicada y visual al estudio de la estad√≠stica descriptiva, utilizando un conjunto de datos reales relacionados con la predicci√≥n de accidentes cerebrovasculares (ACV). A trav√©s de herramientas como R, aplicaciones Shiny y visualizaciones din√°micas, el lector podr√° explorar variables categ√≥ricas y num√©ricas, interpretar sus distribuciones, y comprender c√≥mo la escala de medici√≥n influye en la selecci√≥n de representaciones gr√°ficas y res√∫menes num√©ricos.

Adem√°s de gr√°ficos cl√°sicos como histogramas, diagramas de caja y gr√°ficos de barras, se incluir√°n recursos interactivos, ejemplos reproducibles y videos tutoriales que fortalecen el aprendizaje aut√≥nomo. Este enfoque busca no solo ense√±ar t√©cnicas estad√≠sticas, sino tambi√©n fomentar una comprensi√≥n cr√≠tica del an√°lisis de datos en escenarios reales.

Al finalizar este recorrido, el lector habr√° adquirido competencias fundamentales para describir datos con claridad, detectar relaciones entre variables y establecer las bases s√≥lidas para futuros an√°lisis inferenciales. Como base de todo estudio cient√≠fico riguroso, la estad√≠stica descriptiva es mucho m√°s que una etapa inicial: es una herramienta poderosa para ver con claridad aquello que los datos tienen por decirnos.

## Contexto del Estudios

Este cap√≠tulo explora un conjunto de datos reales proveniente del [Stroke Prediction Dataset](https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset), disponible tambi√©n en [Github](https://github.com/DeiverSuarez/Bioestadistica/blob/main/healthcare-dataset-stroke-data.csv). El dataset contiene informaci√≥n demogr√°fica, m√©dica y de comportamiento de pacientes, con el objetivo de predecir la ocurrencia de accidentes cerebrovasculares (ACV).

Utilizaremos herramientas de estad√≠stica descriptiva para explorar y resumir los datos, apoy√°ndonos en visualizaciones gr√°ficas, c√≥digo en R, aplicaciones Shiny y recursos audiovisuales complementarios.

## Clasificaci√≥n y Tipos de Variables

En la siguiente tabla se presenta una descripci√≥n de las variables del conjunto de datos, clasificadas seg√∫n su tipo (categ√≥rica o cuantitativa) y su escala de medici√≥n. Es importante esta clasificaci√≥n para elegir representaciones gr√°ficas adecuadas.

```{r, echo=FALSE}
library(knitr)
library(kableExtra)

summary_df_simple <- data.frame(
  Variable = c("gender", "age", "hypertension", "heart_disease", "ever_married", "work_type",
               "Residence_type", "avg_glucose_level", "bmi", "smoking_status", "stroke"),
  `Tipo.de.Variable` = c("Categ√≥rica", "Cuantitativa", "Categ√≥rica", "Categ√≥rica", "Categ√≥rica", "Categ√≥rica",
                         "Categ√≥rica", "Cuantitativa", "Cuantitativa", "Categ√≥rica", "Categ√≥rica"),
  `Escala.de.Medici√≥n` = c("Nominal", "Ratio", "Ordinal", "Nominal", "Nominal", "Nominal",
                           "Nominal", "Ratio", "Ratio", "Nominal", "Nominal")
)

kable(summary_df_simple, format = "html", caption = "Tabla de clasificaci√≥n de variables") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F, position = "center") %>%
  column_spec(1, bold = TRUE)
```

------------------------------------------------------------------------

## Carga y descripci√≥n del conjunto de datos

```{r}
datos <- read.csv("healthcare-dataset-stroke-data.csv")
head(datos)
```

**Importante**: Es importante destacar que la variable bmi contiene valores faltantes codificados como "N/A" en formato de texto, lo cual impide que R la reconozca autom√°ticamente como variable num√©rica. Esta situaci√≥n puede afectar el c√°lculo de estad√≠sticas resumen y la generaci√≥n de gr√°ficos como histogramas y boxplots.

Para resolverlo, es necesario reemplazar los valores "N/A" por NA (la forma correcta de representar datos faltantes en R) y luego convertir la columna a tipo num√©rico. A continuaci√≥n se muestra el c√≥digo utilizado para esta limpieza, seguido de los primeros 20 valores de la variable bmi como ejemplo ilustrativo:

```{r}
datos$bmi[datos$bmi == "N/A"] <- NA  # Reemplazar "N/A" por NA en la variable bmi.
datos$bmi <- as.numeric(datos$bmi)   # Convertir la variable bmi a num√©rica.
datos$bmi[1:20]                      # Los primeros 20 datos de la variable bmi.
```

## Variables Cuantitativa

Las variables cuantitativas del conjunto de datos ‚Äîaquellas de naturaleza num√©rica, ya sean continuas o discretas, que permiten realizar operaciones aritm√©ticas y an√°lisis estad√≠sticos‚Äî son: age (edad), avg_glucose_level (nivel promedio de glucosa en sangre) y bmi (√≠ndice de masa corporal).

A continuaci√≥n, se presenta un panel comparativo que resume gr√°ficamente la distribuci√≥n de tres variables num√©ricas clave del conjunto de datos: edad, nivel promedio de glucosa en sangre e √≠ndice de masa corporal (IMC). Para cada variable se incluyen tres tipos de gr√°ficos que son estandar para variables cuantitativa:

-   Un histograma para visualizar la frecuencia de los valores.

-   Un boxplot para identificar la mediana, rango intercuart√≠lico y posibles valores at√≠picos.

-   Una curva de densidad para observar la forma suavizada de la distribuci√≥n.

Estos gr√°ficos se organizan en una matriz de 3 filas y 3 columnas, permitiendo una comparaci√≥n visual clara y simult√°nea entre las variables, facilitando la identificaci√≥n de patrones como asimetr√≠as, concentraciones y valores extremos.

```{r, code-fold: true}
# Instalar patchwork si no lo tienes
# install.packages("patchwork")

library(ggplot2)
library(patchwork)

# Gr√°ficos para 'age'
p1 <- ggplot(datos, aes(x = age)) +
  geom_histogram(bins = 30, fill = "#69b3a2", color = "white") +
  labs(title = "Histograma de Edad", x = NULL, y = "Frecuencia") +
  theme_minimal()

p2 <- ggplot(datos, aes(y = age)) +
  geom_boxplot(fill = "#FF9999") +
  labs(title = "Boxplot de Edad", x = NULL, y = NULL) +
  theme_minimal()

p3 <- ggplot(datos, aes(x = age)) +
  geom_density(fill = "#404080", alpha = 0.4) +
  labs(title = "Densidad de Edad", x = NULL, y = "Densidad") +
  theme_minimal()

# Gr√°ficos para 'avg_glucose_level'
p4 <- ggplot(datos, aes(x = avg_glucose_level)) +
  geom_histogram(bins = 30, fill = "#69b3a2", color = "white") +
  labs(title = "Histograma de Glucosa", x = NULL, y = "Frecuencia") +
  theme_minimal()

p5 <- ggplot(datos, aes(y = avg_glucose_level)) +
  geom_boxplot(fill = "#FF9999") +
  labs(title = "Boxplot de Glucosa", x = NULL, y = NULL) +
  theme_minimal()

p6 <- ggplot(datos, aes(x = avg_glucose_level)) +
  geom_density(fill = "#404080", alpha = 0.4) +
  labs(title = "Densidad de Glucosa", x = NULL, y = "Densidad") +
  theme_minimal()

# Gr√°ficos para 'bmi'
p7 <- ggplot(datos, aes(x = bmi)) +
  geom_histogram(bins = 30, fill = "#69b3a2", color = "white") +
  labs(title = "Histograma de IMC", x = "IMC", y = "Frecuencia") +
  theme_minimal()

p8 <- ggplot(datos, aes(y = bmi)) +
  geom_boxplot(fill = "#FF9999") +
  labs(title = "Boxplot de IMC", x = "IMC", y = NULL) +
  theme_minimal()

p9 <- ggplot(datos, aes(x = bmi)) +
  geom_density(fill = "#404080", alpha = 0.4, na.rm = TRUE) +
  labs(title = "Densidad de IMC", x = "IMC", y = "Densidad") +
  theme_minimal()

# Unir todos los gr√°ficos en una sola figura: 3 columnas x 3 filas
panel_final <- (p1 | p4 | p7) /
               (p2 | p5 | p8) /
               (p3 | p6 | p9) +
               plot_annotation(title = "Distribuciones para Variables Cuantitativas",
                               theme = theme(plot.title = element_text(hjust = 0.5, face = "bold")))

# Mostrar el panel completo
panel_final
```

::: {.callout-note title="Figura 1"}
La figura presenta un resumen visual de tres variables cuantitativas clave del conjunto de datos: edad, nivel promedio de glucosa en sangre e √≠ndice de masa corporal (IMC). Para cada variable se muestran tres representaciones gr√°ficas: un histograma (distribuci√≥n de frecuencias), un diagrama de caja (boxplot) y una curva de densidad (estimaci√≥n suavizada de la distribuci√≥n).
:::

üîπ Edad

-   El histograma de edad revela una distribuci√≥n aproximadamente uniforme entre los 20 y 80 a√±os, aunque con una ligera acumulaci√≥n en adultos mayores.

-   El boxplot indica una mediana cercana a los 50 a√±os, sin valores extremos evidentes.

-   La curva de densidad refuerza la percepci√≥n de una distribuci√≥n dispersa, sin fuerte sesgo.

üîπ Nivel de glucosa promedio

-   El histograma muestra una clara asimetr√≠a positiva (sesgo a la derecha), con muchos pacientes en el rango de 80‚Äì150 mg/dL y pocos con niveles superiores a 200.

-   El boxplot confirma esta asimetr√≠a al mostrar varios outliers por encima del tercer cuartil.

-   La densidad sugiere una distribuci√≥n no normal, lo cual podr√≠a requerir transformaci√≥n si se usa en modelos param√©tricos.

üîπ IMC (√çndice de masa corporal)

-   El histograma de IMC muestra una distribuci√≥n centrada en valores entre 25 y 35, compatibles con sobrepeso y obesidad.

-   El boxplot evidencia muchos valores at√≠picos hacia arriba, aunque la mediana est√° alrededor de 28.

-   La curva de densidad presenta una forma unimodal con cola derecha, tambi√©n indicando asimetr√≠a.

Este tipo de visualizaci√≥n conjunta permite al lector comparar la forma, dispersi√≥n y simetr√≠a de las variables num√©ricas m√°s relevantes del estudio. Tambi√©n sirve como base para tomar decisiones estad√≠sticas posteriores, como transformaciones, imputaci√≥n de valores extremos o segmentaci√≥n de la muestra por rangos cl√≠nicos.

### Medidas de tendencia central

Las medidas de tendencia central ‚Äîmedia, mediana y moda‚Äî permiten resumir un conjunto de datos num√©ricos mediante un valor representativo. La comparaci√≥n entre estas tres medidas es particularmente √∫til para identificar el sesgo de una distribuci√≥n:

-   Sesgo a la izquierda (asimetr√≠a negativa): ocurre cuando media \< mediana \< moda.

-   Distribuci√≥n sim√©trica o normal: se presenta cuando media ‚âà mediana ‚âà moda.

-   Sesgo a la derecha (asimetr√≠a positiva): se identifica cuando moda \< mediana \< media.

Esta comparaci√≥n gr√°fica entre las tres medidas permite interpretar de forma visual la forma y simetr√≠a de la distribuci√≥n de los datos, como se ilustra en la siguiente figura:

```{r, echo=FALSE}
# Librer√≠as necesarias
library(ggplot2)
library(gridExtra)
library(grid)
library(dplyr)
library(cowplot)

# Funci√≥n para obtener la moda
moda <- function(x) {
  d <- density(x)
  d$x[which.max(d$y)]
}

# Simular los datos
set.seed(126)
right_skew <- rgamma(3000, shape = 2, scale = 30)

symmetric <- rnorm(5000, mean = 50, sd = 70)
left_skew <- 100 - right_skew 

# Funci√≥n para crear gr√°fico
crear_grafico <- function(datos, titulo, mostrar_leyenda = TRUE) {
  df <- data.frame(x = datos)
  media <- mean(df$x)
  mediana <- median(df$x)
  moda_val <- moda(df$x)
  
  y_max <- max(density(df$x)$y)
  y_min <- min(density(df$x)$y)
  
  lineas <- data.frame(
    nombre = factor(c("Media", "Mediana", "Moda"), levels = c("Media", "Mediana", "Moda")),
    x = c(media, mediana, moda_val),
    xend = c(media, mediana, moda_val),
    y = rep(y_min, 3),
    yend = rep(y_max, 3)
  )
  
  ggplot(df, aes(x)) +
    geom_histogram(aes(y = ..density..), bins = 50,
                   fill = "lightblue", color = "black", alpha = 0.5) +
    geom_density(color = "blue", size = 0.8) +
    geom_segment(data = lineas,
                 aes(x = x, xend = xend, y = y, yend = yend,
                     color = nombre, linetype = nombre),
                 size = 1.0, show.legend = mostrar_leyenda) +
    scale_color_manual(
      values = c("Media" = "red", "Mediana" = "red", "Moda" = "red")
    ) +
    scale_linetype_manual(
      values = c("Media" = "solid", "Mediana" = "dashed", "Moda" = "dotted")
    ) +
    labs(title = titulo, x = NULL, y = NULL, color = "Medidas", linetype = "Medidas") +
    theme_minimal(base_size = 10) +
    theme(
      plot.title = element_text(hjust = 0.5, face = "bold", size = 11),
      axis.title = element_blank(),
      axis.text = element_text(size = 9),
      legend.title = element_text(face = "bold", size = 10),
      legend.text = element_text(size = 9),
      legend.position = ifelse(mostrar_leyenda, "right", "none"),  # üëà leyenda a la derecha como el ejemplo
      legend.box = "vertical"
    )
}

# Crear gr√°fico con leyenda
g_leyenda <- crear_grafico(right_skew, "Sesgo a la derecha\n(Moda < Mediana < Media)", mostrar_leyenda = TRUE)
leyenda <- cowplot::get_legend(g_leyenda)

# Crear gr√°ficos sin leyenda
g1 <- crear_grafico(right_skew, "Sesgo a la derecha\n(Moda < Mediana < Media)", mostrar_leyenda = FALSE)
g2 <- crear_grafico(symmetric, "Distribuci√≥n sim√©trica\n(Media ~ Mediana ~ Moda)", mostrar_leyenda = FALSE)
g3 <- crear_grafico(left_skew, "Sesgo a la izquierda\n(Media < Mediana < Moda)", mostrar_leyenda = FALSE)

# Panel de 3 gr√°ficos
panel_graficos <- cowplot::plot_grid(g1, g2, g3, ncol = 3, align = "hv")

# Combinar panel con leyenda a la derecha
panel_completo <- cowplot::plot_grid(panel_graficos, leyenda, ncol = 2, rel_widths = c(1, 0.15))

# T√≠tulo general
titulo <- grid::textGrob("Comparaci√≥n entre Media, Mediana y Moda", gp = gpar(fontsize = 13, fontface = "bold"))

# Mostrar resultado completo
gridExtra::grid.arrange(
  titulo,
  panel_completo,
  ncol = 1,
  heights = c(0.07, 1)
)
```

::: {.callout-note title="Figura 2"}
La figura ilustra distintos tipos de asimetr√≠a. Cada gr√°fico presenta un histograma de densidad, junto con las posiciones de la media (l√≠nea continua roja), la mediana (l√≠nea discontinua roja) y la moda (l√≠nea punteada roja). Esta comparaci√≥n permite identificar el tipo de sesgo en una distribuci√≥n y, en consecuencia, evaluar cu√°l medida de tendencia central es m√°s representativa para resumir los datos.
:::

Las tres medidas de tendencia central ‚Äîmedia, mediana y moda‚Äî resumen un conjunto de datos num√©ricos con un valor representativo, pero cada una responde de forma distinta a la naturaleza de los datos. La media es la m√°s utilizada por su sensibilidad a todos los valores, lo cual la hace ideal para datos sim√©tricos y sin valores extremos. Sin embargo, esa misma sensibilidad la convierte en una medida poco robusta ante valores at√≠picos o distribuciones sesgadas. La mediana, al depender √∫nicamente del valor central, es mucho m√°s resistente a los extremos, lo que la hace preferible cuando los datos presentan asimetr√≠a o outliers. Por su parte, la moda es √∫til para identificar el valor m√°s frecuente, siendo especialmente relevante en distribuciones categ√≥ricas o multimodales. La elecci√≥n de una u otra medida depende del tipo de datos, la presencia de valores at√≠picos, el objetivo del an√°lisis y la forma de la distribuci√≥n. En general, se utiliza la media cuando la distribuci√≥n es sim√©trica y no presenta valores extremos; la mediana cuando se quiere una medida robusta en presencia de asimetr√≠a; y la moda cuando se desea conocer el valor m√°s com√∫n o en el an√°lisis de variables cualitativas.

| **Medida**  | **Ventajas**                                                                                                      | **Desventajas**                                                                      | **Cu√°ndo usarla**                                                              | **F√≥rmula**                                                                                             |
|---------------|---------------|---------------|---------------|---------------|
| **Media**   | ‚Ä¢ Utiliza toda la informaci√≥n de los datos <br> ‚Ä¢ F√°cil de calcular <br> ‚Ä¢ Compatible con operaciones algebraicas | ‚Ä¢ Afectada por valores extremos <br> ‚Ä¢ No adecuada para distribuciones sesgadas      | ‚Ä¢ Distribuciones sim√©tricas <br> ‚Ä¢ Ausencia de valores at√≠picos significativos | $\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i$                                                              |
| **Mediana** | ‚Ä¢ Robusta frente a outliers <br> ‚Ä¢ Recomendable para datos sesgados                                               | ‚Ä¢ No incorpora toda la informaci√≥n <br> ‚Ä¢ Dif√≠cil de usar en expresiones algebraicas | ‚Ä¢ Distribuciones asim√©tricas <br> ‚Ä¢ Datos con valores extremos                 | Si $n$ es impar: valor central <br> Si $n$ es par: $\text{Mediana} = \frac{x_{(n/2)} + x_{(n/2+1)}}{2}$ |
| **Moda**    | ‚Ä¢ Indica el valor m√°s frecuente <br> ‚Ä¢ Apta para datos categ√≥ricos                                                | ‚Ä¢ Puede haber m√°s de una <br> ‚Ä¢ No siempre representa bien la tendencia central      | ‚Ä¢ Variables cualitativas <br> ‚Ä¢ Distribuciones multimodales                    | $\text{Moda} = \arg\max_x f(x)$                                                                         |

**Ejemplo:** Se exploran tres medidas de tendencia central fundamentales: media, mediana y moda, aplicadas a las variables cuantitativas del conjunto de datos sobre predicci√≥n de accidentes cerebrovasculares (ACV).

**C√°lculo en R**

Las funciones b√°sicas utilizadas en R para calcular estas medidas son:

-   mean(): calcula la media aritm√©tica.

-   median(): calcula la mediana, es decir, el valor central de los datos ordenados.

-   table() combinado con which.max() o mode(): permite determinar la(s) moda(s), es decir, los valores m√°s frecuentes.

A continuaci√≥n, se presentan los resultados para tres variables clave: edad (age), nivel promedio de glucosa (avg_glucose_level) e √≠ndice de masa corporal (bmi).

```{r}
# Cargar librer√≠as necesarias
library(dplyr)
library(knitr)

# Calcular media, mediana y moda para variables cuantitativas
medidas_tendencia <- data.frame(
  Variable = c("Edad", "Glucosa promedio", "√çndice de masa corporal"),
  Media = c(mean(datos$age, na.rm = TRUE),
            mean(datos$avg_glucose_level, na.rm = TRUE),
            mean(datos$bmi, na.rm = TRUE)),
  Mediana = c(median(datos$age, na.rm = TRUE),
              median(datos$avg_glucose_level, na.rm = TRUE),
              median(datos$bmi, na.rm = TRUE)),
  Moda = c(
    as.numeric(names(which.max(table(datos$age)))),
    as.numeric(names(which.max(table(datos$avg_glucose_level)))),
    as.numeric(names(which.max(table(datos$bmi))))
  )
)

# Redondear para mejor presentaci√≥n
medidas_tendencia <- medidas_tendencia %>%
  mutate(across(Media:Moda, ~round(., 2)))

# Mostrar tabla con formato atractivo
kable(medidas_tendencia, caption = "Medidas de tendencia central para variables cuantitativas")
```

La tabla muestra las medidas de tendencia central ‚Äîmedia, mediana y moda‚Äî para tres variables cuantitativas: edad, glucosa promedio e √≠ndice de masa corporal. A partir del orden de estos valores, es posible interpretar la forma de la distribuci√≥n de cada variable en el conjunto de datos.

En el caso de la glucosa promedio, se observa que la media (106.15) es mayor que la mediana (91.88), y esta a su vez mayor que la moda (93.88). Este patr√≥n indica que la distribuci√≥n est√° sesgada a la derecha, probablemente debido a la presencia de algunos pacientes con niveles de glucosa anormalmente altos, lo cual eleva la media respecto a las otras medidas.

Para el √≠ndice de masa corporal, las tres medidas son muy similares: la media es 28.89, la mediana 28.10 y la moda 28.70. Esta cercan√≠a sugiere que los datos est√°n distribuidos de manera aproximadamente sim√©trica, sin evidencia de valores extremos que afecten significativamente la forma de la distribuci√≥n.

En cuanto a la edad, se observa que la media (43.23) es menor que la mediana (45.00), y esta a su vez menor que la moda (78.00). Este orden sugiere que la distribuci√≥n est√° sesgada a la izquierda, lo cual podr√≠a reflejar que, aunque la mayor√≠a de los pacientes son adultos mayores (de ah√≠ la moda alta), hay tambi√©n una proporci√≥n importante de personas j√≥venes que disminuyen el valor promedio.

Estas observaciones permiten comprender mejor las caracter√≠sticas de cada variable y anticipar decisiones estad√≠sticas m√°s adecuadas para su an√°lisis posterior.

### Medidas de Variabilidad

**¬øQu√© son y por qu√© son importantes?**

Las medidas de tendencia central como la media y la mediana nos indican el valor "t√≠pico" o central de una variable, pero no nos dicen cu√°n dispersos est√°n los datos en torno a ese valor. Dos conjuntos de datos pueden tener la misma media, pero comportamientos completamente distintos si uno es m√°s homog√©neo y el otro m√°s variable, como se ilustra en la Figura 3. Para capturar esa informaci√≥n, recurrimos a las medidas de variabilidad.

Estas medidas cuantifican el grado en que los valores de una variable num√©rica se alejan del centro. Son fundamentales para:

-   Evaluar la estabilidad o consistencia de los datos.

-   Comparar la dispersi√≥n entre distintos grupos o variables.

-   Detectar valores at√≠picos.

-   Preparar el terreno para an√°lisis inferenciales como pruebas de hip√≥tesis o regresi√≥n.

```{r, echo=FALSE}
# Cargar librer√≠as necesarias
library(ggplot2)
library(dplyr)
library(patchwork)

# Semilla para reproducibilidad
set.seed(123)

# Datos con misma media pero diferente dispersi√≥n
homogeneo <- rnorm(1000, mean = 5, sd = 1)
heterogeneo <- rnorm(1000, mean = 5, sd = 3.5)

# Crear dataframes
df1 <- data.frame(valor = heterogeneo, grupo = "Alta variabilidad")
df2 <- data.frame(valor = homogeneo, grupo = "Baja variabilidad")

# Funci√≥n general para graficar
graficar_histograma <- function(df, titulo, color_hist, color_dens) {
  ggplot(df, aes(x = valor)) +
    geom_histogram(aes(y = ..density..), bins = 50, fill = color_hist, color = "black", alpha = 0.6) +
    geom_density(color = color_dens, linewidth = 1.2) +
    geom_vline(xintercept = mean(df$valor), color = "black", linewidth = 2.5) +
    labs(title = titulo, x = "", y = "Densidad") +
    coord_cartesian(xlim = c(-5, 15)) +
    theme_minimal(base_size = 14) +
    theme(
      plot.title = element_text(face = "bold", hjust = 0.5),
      axis.title.y = element_text(face = "bold")
    )
}
# Crear los gr√°ficos con colores distintos
g1 <- graficar_histograma(df1, "Distribuci√≥n con alta variabilidad", "#FFA07A", "#D62828")
g2 <- graficar_histograma(df2, "Distribuci√≥n con baja variabilidad", "#90EE90", "#007F5F")

# Combinar en panel
g1 / g2 + plot_annotation(
  title = "Comparaci√≥n de distribuciones con igual media",
  theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"))
)
```

::: {.callout-note title="Figura 3"}
Comparaci√≥n de distribuciones con igual media pero diferente variabilidad. Se muestran dos conjuntos de datos con una media com√∫n de 5, pero con diferente dispersi√≥n. En la parte superior, la distribuci√≥n con alta variabilidad (desviaci√≥n est√°ndar ‚âà 3.5), presenta una forma m√°s aplanada y extendida, mientras que en la parte inferior, la distribuci√≥n con baja variabilidad (desviaci√≥n est√°ndar ‚âà 1), es m√°s estrecha y concentrada alrededor de la media. La l√≠nea vertical negra indica la posici√≥n de la media en ambos casos, mostrando que, a pesar de las diferencias en dispersi√≥n, ambas distribuciones est√°n centradas en el mismo valor. Esta visualizaci√≥n permite apreciar gr√°ficamente el impacto de la variabilidad en la forma de la distribuci√≥n de los datos.
:::

A continuaci√≥n, exploraremos las principales medidas de dispersi√≥n con ejemplos reales del conjunto de datos sobre ACV.

#### **Rango**

El **rango** es la forma m√°s simple de medir la dispersi√≥n, refleja la amplitud total de los datos, indicando el intervalo en el que se distribuyen los valores observados. Se calcula como la diferencia entre el valor m√°ximo y el valor m√≠nimo.

$$
\text{Rango} = x_{\text{m√°x}} - x_{\text{m√≠n}}
$$

**Ventajas:** f√°cilde calcular e interpretar.\
**Desventajas:** My sensible a valores extremos.

```{r}
# C√°lculo del m√≠nimo, m√°ximo y rango para cada variable
min_age <- min(datos$age, na.rm = TRUE)
max_age <- max(datos$age, na.rm = TRUE)
rango_age <- max_age - min_age

min_glucosa <- min(datos$avg_glucose_level, na.rm = TRUE)
max_glucosa <- max(datos$avg_glucose_level, na.rm = TRUE)
rango_glucosa <- max_glucosa - min_glucosa

min_bmi <- min(datos$bmi, na.rm = TRUE)
max_bmi <- max(datos$bmi, na.rm = TRUE)
rango_bmi <- max_bmi - min_bmi

# Crear la tabla con M√≠nimo, M√°ximo y Rango
tabla_rango <- data.frame(
  Variable = c("Edad (age)", "Glucosa (avg_glucose_level)", "IMC (bmi)"),
  M√≠nimo = round(c(min_age, min_glucosa, min_bmi), 2),
  M√°ximo = round(c(max_age, max_glucosa, max_bmi), 2),
  Rango = round(c(rango_age, rango_glucosa, rango_bmi), 2)
)

# Mostrar tabla con bordes y estilo
library(knitr)
library(kableExtra)

kable(tabla_rango, format = "html", align = "lccc", caption = "") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered", "condensed"), full_width = FALSE)
```
En la variable **edad**, se observa un rango de 81.92 a√±os, con valores que van desde 0.08 hasta 82 a√±os. Esta amplitud tan grande sugiere que el conjunto de datos incluye desde beb√©s o lactantes hasta adultos mayores. Dado que la edad es uno de los principales factores de riesgo en la ocurrencia de ACV, esta amplia cobertura etaria permite evaluar c√≥mo var√≠a el riesgo a lo largo del ciclo vital. Tambi√©n indica la necesidad de estratificar los an√°lisis por grupos etarios, ya que los mecanismos fisiopatol√≥gicos y los factores de riesgo pueden ser distintos en j√≥venes y adultos mayores.

En cuanto a la glucosa promedio en sangre, el rango observado es de 216.62 mg/dL, lo que implica una diferencia significativa entre pacientes con normoglucemia (valores m√≠nimos en torno a 55 mg/dL) y aquellos con hiperglucemia severa (valores superiores a 270 mg/dL). Este hallazgo es altamente relevante para el objetivo del estudio, ya que la disglucemia ‚Äîespecialmente en forma de diabetes mal controlada‚Äî es un factor de riesgo establecido para ACV. La gran dispersi√≥n en los niveles de glucosa sugiere la presencia de m√∫ltiples perfiles metab√≥licos dentro de la muestra, desde pacientes sanos hasta personas en alto riesgo cardiovascular.

Por √∫ltimo, el IMC presenta un rango de 87.30 kg/m¬≤, con valores que van desde 10.3 (indicativo de desnutrici√≥n severa) hasta 97.6 (obesidad m√≥rbida extrema). Esta amplitud sugiere una gran heterogeneidad en el estado nutricional de los pacientes. Dado que tanto la desnutrici√≥n como la obesidad se han asociado con eventos cerebrovasculares, este hallazgo refuerza la importancia de considerar el IMC no solo como una variable continua, sino tambi√©n categorizada en rangos cl√≠nicos para evaluar su impacto sobre la ocurrencia de ACV.

En conjunto, estos rangos muestran que el conjunto de datos es diverso y permite explorar asociaciones entre variables cl√≠nicas y la ocurrencia de ACV en distintos perfiles de pacientes, lo cual es fundamental para desarrollar modelos predictivos robustos y generalizables.



#### **Rango Intercuart√≠lico (IQR)**

El **rango intercuart√≠lico (IQR)** mide la dispersi√≥n del 50% central de los datos. A diferencia del rango total, el IQR es robusto frente a valores extremos, lo que lo convierte en una medida m√°s confiable para evaluar la variabilidad real de los datos. El IQR se calcula como la diferencia entre el tercer cuartil (Q3) y el primer cuartil (Q1):

$$
\text{IQR} = Q_3 - Q_1
$$

donde $Q_1$ es el primer cuartil (percentil 25) y el $Q_3$ tercer cuartil (percentil 75).


**Ventajas:** robusta frente a valores extremos.\
**Desventajas:** no considera todos los datos (Ignora extremos de la distribuci√≥n).

```{r}
# C√°lculo del IQR y cuartiles para cada variable
iqr_age <- IQR(datos$age, na.rm = TRUE)
q1_age <- quantile(datos$age, 0.25, na.rm = TRUE)
q3_age <- quantile(datos$age, 0.75, na.rm = TRUE)

iqr_glucosa <- IQR(datos$avg_glucose_level, na.rm = TRUE)
q1_glucosa <- quantile(datos$avg_glucose_level, 0.25, na.rm = TRUE)
q3_glucosa <- quantile(datos$avg_glucose_level, 0.75, na.rm = TRUE)

iqr_bmi <- IQR(datos$bmi, na.rm = TRUE)
q1_bmi <- quantile(datos$bmi, 0.25, na.rm = TRUE)
q3_bmi <- quantile(datos$bmi, 0.75, na.rm = TRUE)

# Crear tabla con los resultados
tabla_iqr <- data.frame(
  Variable = c("Edad (age)", "Glucosa (avg_glucose_level)", "IMC (bmi)"),
  Q1 = round(c(q1_age, q1_glucosa, q1_bmi), 2),
  Q3 = round(c(q3_age, q3_glucosa, q3_bmi), 2),
  IQR = round(c(iqr_age, iqr_glucosa, iqr_bmi), 2)
)

# Mostrar tabla con estilo
library(knitr)
library(kableExtra)

kable(tabla_iqr, format = "html", align = "lccc", caption = "") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered", "condensed"))
```
En la variable **edad**, el IQR es de 36 a√±os, con un Q1 de 25 y un Q3 de 61. Esto indica que la mitad central de los pacientes tiene entre 25 y 61 a√±os, lo que sugiere una poblaci√≥n predominantemente adulta joven a adulta mayor. Este resultado es cl√≠nicamente relevante, ya que los ACV son m√°s frecuentes en adultos mayores, pero el hecho de que muchos pacientes est√©n por debajo de los 60 a√±os refuerza la importancia de monitorear factores de riesgo en edades m√°s tempranas. La amplitud del IQR tambi√©n sugiere una considerable diversidad etaria en el segmento central de la muestra.

Para la glucosa promedio, el IQR es de 36.85 mg/dL, con valores entre 77.24 (Q1) y 114.09 (Q3). Esto significa que el 50% de los pacientes tiene niveles de glucosa en un rango que abarca desde la normoglucemia hasta valores que podr√≠an indicar prediabetes. La amplitud de este IQR es cl√≠nicamente significativa: muestra que incluso en el rango intermedio hay suficiente variabilidad como para detectar perfiles metab√≥licos distintos, lo que es esencial para construir modelos predictivos que incluyan la glucosa como variable de riesgo para ACV.

En el caso del IMC, el IQR es de 9.6 kg/m¬≤, con valores entre 23.5 y 33.1. Este intervalo cubre desde el l√≠mite superior del peso normal hasta el rango de obesidad moderada. Por tanto, la mitad central de la muestra se encuentra en un estado nutricional que ya representa un riesgo metab√≥lico elevado. Esto refuerza la utilidad del IMC como predictor de ACV en la muestra analizada, y sugiere que muchos pacientes podr√≠an beneficiarse de intervenciones de control de peso como medida preventiva.

En conjunto, estos IQRs reflejan una variabilidad cl√≠nica importante dentro del n√∫cleo de la muestra. Esta heterogeneidad en edad, glucosa e IMC entre los pacientes refuerza la necesidad de modelos de predicci√≥n ajustados por estos factores para identificar con mayor precisi√≥n el riesgo de accidente cerebrovascular.

#### Varianza

La **varianza** mide la dispersi√≥n promedio de los datos con respecto a su media, elevando al cuadrado las diferencias para evitar cancelaciones, por lo que sus unidades est√°n al cuadrado. Aunque no es directamente interpretable en las unidades originales, es una medida fundamental para an√°lisis estad√≠sticos avanzados como la regresi√≥n o el an√°lisis de componentes principales.

$$
s^2 = \frac{1}{n - 1} \sum_{i=1}^{n} (x_i - \bar{x})^2
$$

donde:

-   $x_i$ es cada observaci√≥n,\
-   $\bar{x}$ es la media,\
-   $n$ es el tama√±o de la muestra.

**Ventajas:** utiliza toda la informaci√≥n.\
**Desventajas:** Es sensible a valores extremos y su unidad est√° elevada al cuadrado, lo que dificulta su interpretaci√≥n directa.

```{r}
# Calcular varianzas
var_age <- var(datos$age, na.rm = TRUE)
var_glucosa <- var(datos$avg_glucose_level, na.rm = TRUE)
var_bmi <- var(datos$bmi, na.rm = TRUE)

# Crear tabla con unidades al cuadrado
tabla_varianza <- data.frame(
  Variable = c("Edad (age)", "Glucosa (avg_glucose_level)", "IMC (bmi)"),
  Varianza = c(
    paste0(round(var_age, 2), " a√±os¬≤"),
    paste0(round(var_glucosa, 2), " (mg/dL)¬≤"),
    paste0(round(var_bmi, 2), " (kg/m¬≤)")
  )
)

# Mostrar tabla con bordes y estilo
library(knitr)
library(kableExtra)

kable(tabla_varianza, format = "html", align = "l", caption = "") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered", "condensed"), full_width = FALSE, position = "center")
```
En la variable **edad**, la varianza es de 511.33 a√±os¬≤, lo cual indica una dispersi√≥n considerable en torno al promedio de edad de la muestra. Este valor confirma lo que ya se hab√≠a observado con el rango y el IQR: la muestra incluye tanto personas j√≥venes como adultos mayores. Esta amplitud es crucial para el estudio, ya que el riesgo de ACV se incrementa con la edad, y contar con una poblaci√≥n diversa permite modelar ese riesgo de manera m√°s realista.

Para la glucosa promedio, se observa una varianza de 2050.6 (mg/dL)¬≤, que es bastante elevada. Esto implica que los niveles de glucosa en sangre en la muestra est√°n altamente dispersos respecto a la media. Esta alta variabilidad podr√≠a estar reflejando la coexistencia de personas con control gluc√©mico normal, pacientes prediab√©ticos y diab√©ticos no controlados. En el contexto del estudio, esta variabilidad es muy valiosa, ya que la hiperglucemia es un factor de riesgo importante para ACV, y la inclusi√≥n de estos extremos permite capturar con mayor precisi√≥n su efecto en los modelos predictivos.

En el caso del IMC, la varianza es de 61.69 (kg/m¬≤)¬≤, lo cual representa una dispersi√≥n moderada en comparaci√≥n con las otras dos variables. Aunque menor que la varianza observada en glucosa y edad, este valor sigue siendo cl√≠nicamente relevante, ya que refleja una poblaci√≥n con diferentes estados nutricionales, desde peso bajo hasta obesidad severa. Esta informaci√≥n es cr√≠tica para el estudio, ya que tanto la desnutrici√≥n como la obesidad han sido asociadas con mayor riesgo de eventos cerebrovasculares.

En resumen, las tres variables muestran varianzas importantes, lo que sugiere una alta heterogeneidad en la muestra. Esta variabilidad es beneficiosa para los fines del estudio, pues permite capturar una gama m√°s amplia de perfiles cl√≠nicos y construir modelos de predicci√≥n de ACV m√°s robustos y generalizables.

#### Desviaci√≥n Est√°ndar

La **desviaci√≥n est√°ndar (SD)** es la ra√≠z cuadrada de la varianza, devolviendo la medida de dispersi√≥n a las mismas unidades que los datos originales. Es una de las medidas de variabilidad m√°s utilizadas debido a su interpretaci√≥n directa y su relevancia en m√©todos estad√≠sticos como regresi√≥n, pruebas de hip√≥tesis y modelos de predicci√≥n.

$$
s = \sqrt{\frac{1}{n - 1} \sum_{i=1}^{n} (x_i - \bar{x})^2}
$$


**Ventajas:** ampliamente utilizada y f√°cil de interpretar.\
**Desventajas:** sensible a valores extremos.

```{r}
# C√°lculo de la desviaci√≥n est√°ndar para cada variable
sd_age <- sd(datos$age, na.rm = TRUE)
sd_glucosa <- sd(datos$avg_glucose_level, na.rm = TRUE)
sd_bmi <- sd(datos$bmi, na.rm = TRUE)

# Crear la tabla con los resultados
tabla_sd <- data.frame(
  Variable = c("Edad (age)", "Glucosa Promedio (avg_glucose_level)", "IMC (bmi)"),
  `Desviaci√≥n Est√°ndar` = round(c(sd_age, sd_glucosa, sd_bmi), 2)
)

# Cargar librer√≠as necesarias
library(knitr)
library(kableExtra)

# Mostrar la tabla con bordes y estilo profesional
kable(tabla_sd, format = "html", align = "l", caption = "") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered", "condensed"), full_width = FALSE)
```
Para la edad, la desviaci√≥n est√°ndar es de 22.61 a√±os. Esto indica que, en promedio, los pacientes se desv√≠an ¬±22.61 a√±os respecto a la edad media. Es una dispersi√≥n alta, lo que confirma la presencia de una poblaci√≥n muy heterog√©nea en t√©rminos etarios, abarcando desde personas j√≥venes hasta adultos mayores. Esta variabilidad es beneficiosa para el objetivo del estudio, ya que permite explorar c√≥mo influye la edad en la ocurrencia de ACV a lo largo de todo el ciclo vital.

En el caso de la glucosa promedio, la desviaci√≥n est√°ndar es de 45.28 mg/dL, lo cual representa una alta dispersi√≥n en comparaci√≥n con su media. Esto refleja que existen diferencias sustanciales entre pacientes normogluc√©micos y aquellos con hiperglucemia severa o diabetes mal controlada. Dado que los niveles elevados de glucosa en sangre est√°n estrechamente relacionados con el riesgo cardiovascular y cerebrovascular, esta variabilidad aporta valor al modelo predictivo del estudio, permitiendo discriminar mejor entre distintos perfiles metab√≥licos.

Por √∫ltimo, la desviaci√≥n est√°ndar del IMC es de 7.85 kg/m¬≤, menor en comparaci√≥n con las otras dos variables, pero a√∫n suficientemente amplia como para reflejar la presencia de pacientes con estados nutricionales muy diversos. Esto incluye desde bajo peso hasta obesidad severa, ambos extremos asociados a un mayor riesgo de ACV. Esta variabilidad, aunque m√°s contenida, sigue siendo cl√≠nicamente relevante y debe considerarse en la interpretaci√≥n y estratificaci√≥n de riesgo.

En conjunto, las desviaciones est√°ndar indican que existe una amplia diversidad cl√≠nica en la muestra analizada. Esta heterogeneidad permite desarrollar modelos estad√≠sticos m√°s robustos y generalizables para predecir el riesgo de ACV, que es el objetivo principal del estudio.


#### Coeficiente de Variaci√≥n (CV)

El **coeficiente de variaci√≥n** es una medida relativa de dispersi√≥n que expresa la desviaci√≥n est√°ndar como porcentaje de la media. El CV es √∫til para comparar la variabilidad de variables con diferentes escalas o unidades. 

$$
CV = \left( \frac{s}{\bar{x}} \right) \times 100\%
$$

**Ventajas:** permite comparar variables heterog√©neas.\
**Desventajas:** no se recomienda cuando la media es cercana a cero.


```{r}
# C√°lculo del Coeficiente de Variaci√≥n (CV) para cada variable
cv_age <- sd(datos$age, na.rm = TRUE) / mean(datos$age, na.rm = TRUE) * 100
cv_glucosa <- sd(datos$avg_glucose_level, na.rm = TRUE) / mean(datos$avg_glucose_level, na.rm = TRUE) * 100
cv_bmi <- sd(datos$bmi, na.rm = TRUE) / mean(datos$bmi, na.rm = TRUE) * 100

# Crear tabla con los CVs
tabla_cv <- data.frame(
  Variable = c("Edad (age)", "Glucosa (avg_glucose_level)", "IMC (bmi)"),
  `Coeficiente de Variaci√≥n (%)` = round(c(cv_age, cv_glucosa, cv_bmi), 2)
)

# Mostrar tabla con bordes y estilo en HTML
library(knitr)
library(kableExtra)

kable(tabla_cv, format = "html", align = "l", caption = "") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered", "condensed"),
                full_width = FALSE, position = "center")

```
En la variable **edad**, el coeficiente de variaci√≥n es de 52.31%, lo cual indica una alta dispersi√≥n relativa respecto a su promedio. Este valor significa que la edad de los pacientes var√≠a m√°s del 50% en relaci√≥n con la media, reflejando una gran heterogeneidad etaria dentro de la muestra. Esta amplitud es relevante en el contexto del estudio, ya que permite analizar el impacto del ACV en diversos grupos etarios, desde j√≥venes hasta adultos mayores, mejorando la generalizaci√≥n de los modelos predictivos.

Para la **glucosa promedio**, el CV es de 42.66%, tambi√©n indicando una alta variabilidad relativa. Este resultado es cl√≠nicamente importante, ya que muestra que los niveles de glucosa en la sangre var√≠an considerablemente entre los pacientes. Esta variabilidad puede deberse a diferencias en el estado metab√≥lico (normoglucemia, prediabetes, diabetes), lo que refuerza la necesidad de incluir esta variable en modelos predictivos de ACV como un factor continuo y potencialmente no lineal.

El **IMC** presenta un CV de 27.18%, lo cual representa la menor variabilidad relativa entre las tres variables. Esto sugiere que, aunque hay diferencias en el estado nutricional de los pacientes, estas son menos marcadas en comparaci√≥n con la edad y la glucosa. Aun as√≠, este grado de variaci√≥n sigue siendo cl√≠nicamente relevante, ya que el IMC sigue siendo un factor de riesgo importante para enfermedades cardiovasculares y cerebrovasculares.

En conjunto, los coeficientes de variaci√≥n confirman que edad y glucosa son las variables m√°s heterog√©neas en t√©rminos relativos, lo que puede implicar una mayor capacidad explicativa en los modelos de predicci√≥n de ACV. El uso del CV permite comparar directamente el grado de dispersi√≥n de variables con distintas unidades y escalas, y por tanto es un indicador clave para priorizar variables en el an√°lisis multivariado.


#### Comparaci√≥n de Medidas de Variabilidad

| Medida              | Ventajas                              | Desventajas                                 | Recomendaci√≥n de uso                |
|----------------|------------------|---------------------|-----------------|
| Rango               | Simple y r√°pida de calcular           | Muy sensible a valores at√≠picos             | Datos exploratorios, no robustos    |
| IQR                 | Robusto, ignora extremos              | No usa todos los datos                      | Comparar distribuciones asim√©tricas |
| Varianza            | Usa toda la informaci√≥n               | Dif√≠cil interpretaci√≥n (unidades cuadradas) | C√°lculos posteriores (inferencia)   |
| Desviaci√≥n est√°ndar | Intuitiva, misma unidad que los datos | Afectada por valores extremos               | Comparaciones est√°ndar entre grupos |
| Coef. de variaci√≥n  | Comparaci√≥n entre variables           | Requiere media diferente de cero            | Comparar dispersi√≥n relativa        |

#### Conclusi√≥n

Las medidas de variabilidad complementan las medidas de tendencia central al describir la dispersi√≥n de los datos. Su correcta elecci√≥n depende del objetivo del an√°lisis y del tipo de datos. En contextos biom√©dicos, donde una peque√±a variaci√≥n puede tener implicaciones cl√≠nicas relevantes, interpretar adecuadamente la variabilidad es crucial para una comprensi√≥n integral de los resultados. Usar varias medidas de forma conjunta suele proporcionar una imagen m√°s completa del comportamiento de la variable.

En el contexto del presente estudio sobre factores asociados al accidente cerebrovascular (ACV), el an√°lisis de las medidas de dispersi√≥n ha permitido evidenciar una alta variabilidad en las variables cl√≠nicas clave del estudio ‚Äîedad, glucosa promedio e IMC‚Äî lo cual es fundamental para interpretar la heterogeneidad de la muestra. Mientras que medidas como el rango y el rango intercuart√≠lico muestran la amplitud general y central de los datos respectivamente, la varianza y la desviaci√≥n est√°ndar cuantifican la dispersi√≥n absoluta, y el coeficiente de variaci√≥n aporta una perspectiva relativa comparativa entre variables con diferentes escalas.

Estos perfiles reflejan que el riesgo de ACV no es uniforme en la muestra, sino que se distribuye en funci√≥n de m√∫ltiples combinaciones de edad, glucemia e IMC. Por ello, es crucial que los an√°lisis estad√≠sticos consideren estas variaciones mediante modelos ajustados o estratificados, para evitar conclusiones simplistas y poder identificar con mayor precisi√≥n subgrupos vulnerables. Esto tambi√©n tiene implicaciones cl√≠nicas importantes para dise√±ar intervenciones dirigidas y medidas preventivas adaptadas a cada perfil.

Esta diversidad en los patrones de dispersi√≥n sugiere la existencia de m√∫ltiples perfiles cl√≠nicos en la muestra, desde j√≥venes con bajo peso hasta adultos mayores con hiperglucemia u obesidad severa. Por tanto, estas medidas no solo complementan las estad√≠sticas de tendencia central, sino que ofrecen una base s√≥lida para construir modelos predictivos m√°s precisos y cl√≠nicamente relevantes. En el contexto del accidente cerebrovascular, donde la interacci√≥n entre factores de riesgo es compleja, comprender la variabilidad de los datos es esencial para identificar subgrupos vulnerables y guiar estrategias preventivas m√°s eficaces.


### Distribuci√≥n de frecuencias para datos agrupados




------------------------------------------------------------------------

### Gr√°ficos descriptivos

### Comparaci√≥n de variables cuantitativas seg√∫n la ocurrencia de ACV (stroke)

Una parte esencial del an√°lisis descriptivo es explorar c√≥mo se comportan las variables cuantitativas en funci√≥n de una variable categ√≥rica relevante. En este caso, se analizan tres indicadores cl√≠nicos ‚Äîedad, nivel promedio de glucosa en sangre (avg_glucose_level) y √≠ndice de masa corporal (bmi)‚Äî comparando su distribuci√≥n entre pacientes que han sufrido un accidente cerebrovascular (ACV o stroke) y aquellos que no lo han sufrido.

Los datos se visualizan mediante diagramas de caja (boxplots), que permiten identificar diferencias en la mediana, dispersi√≥n y presencia de valores at√≠picos entre los dos grupos. Estos gr√°ficos se organizan en una matriz de 1 fila por 3 columnas, lo que permite una comparaci√≥n visual clara y simult√°nea entre las tres variables. Esta disposici√≥n facilita la detecci√≥n de patrones relevantes, como asimetr√≠as, concentraciones de valores o extremos, que podr√≠an estar asociados con el riesgo de sufrir un ACV.

```{r}
library(ggplot2)
library(patchwork)
library(readr)
library(dplyr)

# Asegurar que stroke sea factor (para que ggplot lo interprete como categor√≠a)
datos$stroke <- factor(datos$stroke, levels = c(0, 1), labels = c("No", "Yes"))

# Crear los boxplots individuales con t√≠tulos alineados a la derecha
p1 <- ggplot(datos, aes(x = stroke, y = age, fill = stroke)) +
  geom_boxplot() +
  labs(title = "Edad por Stroke", x = "Stroke", y = "Edad") +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 1, face = "bold")  # Alineaci√≥n derecha
  )

p2 <- ggplot(datos, aes(x = stroke, y = avg_glucose_level, fill = stroke)) +
  geom_boxplot() +
  labs(title = "Glucosa por Stroke", x = "Stroke", y = "Avg Glucose Level") +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 1, face = "bold")
  )

p3 <- ggplot(datos, aes(x = stroke, y = bmi, fill = stroke)) +
  geom_boxplot() +
  labs(title = "IMC por Stroke", x = "Stroke", y = "BMI") +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 1, face = "bold")
  )

# Panel con los tres gr√°ficos
panel <- p1 | p2 | p3
panel
```

El gr√°fico anterior muestra c√≥mo var√≠an tres variables cuantitativas clave ‚Äîedad, nivel promedio de glucosa en sangre y √≠ndice de masa corporal (IMC)‚Äî entre pacientes que no han sufrido un accidente cerebrovascular (ACV) (grupo ‚ÄúNo‚Äù) y aquellos que s√≠ lo han sufrido (grupo ‚ÄúYes‚Äù).

-   Edad: Se observa una diferencia clara entre los grupos. Los pacientes con ACV tienden a ser considerablemente mayores, con una mediana por encima de los 70 a√±os, mientras que los que no han tenido ACV presentan una mediana cercana a los 40 a√±os. Esto sugiere una fuerte asociaci√≥n entre la edad avanzada y la ocurrencia de ACV.

-   Nivel de glucosa: Aunque existe una mayor dispersi√≥n entre los pacientes con ACV (con valores m√°s extremos), tambi√©n se evidencia una mediana ligeramente m√°s alta en comparaci√≥n con el grupo sin ACV. Adem√°s, se detectan muchos valores at√≠picos (outliers), en quienes no han sufrido ACV.

-   IMC: La distribuci√≥n del IMC es bastante similar entre ambos grupos, con medianas cercanas a 28. Sin embargo, se nota una mayor variabilidad y presencia de valores extremos en el grupo sin ACV. Esto indica que, en esta muestra, el IMC no parece estar tan claramente asociado con la ocurrencia de ACV como la edad o la glucosa.

Esta visualizaci√≥n es √∫til para generar hip√≥tesis preliminares sobre posibles factores de riesgo. Por ejemplo, los resultados sugieren que la edad avanzada y niveles elevados de glucosa podr√≠an estar relacionados con mayor riesgo de ACV, mientras que el IMC no presenta una diferencia tan marcada.

## Exploraci√≥n de relaciones entre variables cuantitativas: matriz de dispersi√≥n entre edad, glucosa y BMI

Una parte esencial del an√°lisis descriptivo consiste en explorar las posibles relaciones entre variables cuantitativas. Esta exploraci√≥n permite detectar patrones, asociaciones o tendencias que podr√≠an ser relevantes desde el punto de vista cl√≠nico o epidemiol√≥gico, y que adem√°s servir√°n como base para futuros modelos predictivos o explicativos.

En este caso, se construye una matriz de dispersi√≥n para visualizar simult√°neamente las relaciones entre tres variables clave: edad, nivel promedio de glucosa en sangre (avg_glucose_level) e √≠ndice de masa corporal (bmi). Esta matriz permite observar:

-   En la diagonal, la distribuci√≥n individual de cada variable mediante histogramas suavizados.

-   En la parte inferior, diagramas de dispersi√≥n (scatterplots) entre pares de variables, lo que facilita visualizar tendencias lineales o no lineales.

-   En la parte superior, los coeficientes de correlaci√≥n de Pearson entre cada par de variables, incluyendo la significancia estad√≠stica.

-   Este tipo de visualizaci√≥n integrada es muy √∫til para detectar correlaciones significativas o posibles relaciones no evidentes a simple vista.

```{r}
library(GGally)
library(ggplot2)
library(readr)
library(dplyr)
library(RColorBrewer)  # Para paletas de colores

df <- datos %>%
  select(age, avg_glucose_level, bmi) %>%
  na.omit()

# Paleta de colores personalizada
color_palette <- brewer.pal(n = 3, name = "Set2")

# Crear matriz de dispersi√≥n mejorada
ggpairs(df,
        title = "Matriz de Dispersi√≥n: Edad, Glucosa y BMI",
        upper = list(continuous = wrap("cor", size = 4, alignPercent = 0.8, col = "darkblue")),
        lower = list(continuous = wrap("points", alpha = 0.6, size = 1.5, color = "#75AADB")),  # üîµ azul RStudio
        diag = list(continuous = wrap("densityDiag", alpha = 0.4, fill = "#A5C8E1"))) +        # üîµ tono m√°s claro
  theme_light(base_size = 14) +
  theme(
    plot.title = element_text(hjust = 1, size = 16, face = "bold", color = "#333333"),
    strip.text = element_text(face = "bold", color = "black"),
    panel.grid = element_line(color = "grey85")
  )
```

La matriz de dispersi√≥n presentada permite identificar relaciones significativas entre las variables cuantitativas consideradas en pacientes con ACV. Espec√≠ficamente, se observa:

-   Una correlaci√≥n positiva moderada entre el √≠ndice de masa corporal (BMI) y la edad (r = 0.333\*\*\*), lo que sugiere que, dentro de este grupo de pacientes, las personas de mayor edad tienden a tener un BMI m√°s alto.

-   Una correlaci√≥n positiva baja entre la edad y el nivel promedio de glucosa (r = 0.236***), as√≠ como entre el BMI y la glucosa (r = 0.176***), lo cual puede indicar una asociaci√≥n d√©bil pero significativa entre estas variables cl√≠nicas.

Adem√°s, los gr√°ficos de densidad en la diagonal permiten identificar la distribuci√≥n asim√©trica de las variables, en especial para avg_glucose_level y bmi, con sesgo a la derecha. Este tipo de visualizaci√≥n multivariada facilita no solo la detecci√≥n de tendencias y valores extremos, sino tambi√©n la evaluaci√≥n preliminar de supuestos para modelos m√°s complejos. En conjunto, esta herramienta es fundamental para comprender la estructura interna de los datos antes de avanzar hacia el an√°lisis inferencial.

## An√°lisis de Variables Categ√≥ricas

Este gr√°fico permite comparar la distribuci√≥n de la edad entre pacientes que han sufrido un ACV (stroke = 1) y los que no (stroke = 0).

```{r}
boxplot(age ~ stroke, data = datos, main = "Edad por Stroke", col = "lightblue")
```

------------------------------------------------------------------------

### Histograma del nivel promedio de glucosa

Este histograma muestra la distribuci√≥n de la variable avg_glucose_level y superpone una curva de densidad para observar su comportamiento general.

```{r}
hist(datos$avg_glucose_level,
     main = "Distribuci√≥n del nivel de glucosa",
     xlab = "Nivel de glucosa",
     col = "lightgreen",
     probability = TRUE, breaks = 50)  # activa escala de densidad

lines(density(datos$avg_glucose_level), col = "darkgreen", lwd = 2)  # curva de densidad
```

------------------------------------------------------------------------

### scatter plot (diagrama de dispersi√≥n) entre las variables Age y Bmi

Esta visualizaci√≥n permite explorar la posible relaci√≥n lineal o no lineal entre la edad y el √≠ndice de masa corporal (BMI).

```{r}
plot(datos$age, datos$bmi, 
     main = "Relaci√≥n entre Edad y BMI",
     xlab = "Edad",
     ylab = "BMI",
     pch = 19, col = "darkblue")
```

## Gr√°ficos descriptivos (Variables Categ√≥ricas)

### Gr√°fico de barras apiladas

Este gr√°fico de barras apiladas normalizadas muestra la proporci√≥n de pacientes con y sin enfermedad card√≠aca, seg√∫n su estatus como fumadores.

```{r}
library(ggplot2)
library(dplyr)
datos %>%
  count(smoking_status, heart_disease) %>%
  group_by(smoking_status) %>%
  mutate(porcentaje = n / sum(n) * 100) %>%
  ggplot(aes(x = smoking_status, y = porcentaje, fill = factor(heart_disease))) +
  geom_col(position = "fill") +
  scale_y_continuous(labels = scales::percent) +
  labs(title = "Proporci√≥n de Heart Disease por Smoking Status",
       x = "Smoking Status", y = "Porcentaje", fill = "Heart Disease") +
  theme_minimal()

```

### graficon de frecuencia absoluta y relativa

A continuaci√≥n, se presentan dos gr√°ficos: el primero muestra la frecuencia absoluta de cada categor√≠a de fumador, mientras que el segundo presenta la frecuencia relativa (en porcentaje).

```{r}
library(patchwork)  # para p1 + p2

# Gr√°fico de frecuencia absoluta
p1 <- ggplot(datos, aes(x = smoking_status)) +
  geom_bar(fill = "steelblue") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 25)) +  # ROTACI√ìN del eje x
  labs(title = "Frecuencia absoluta smoking status", x = "Smoking Status", y = "Frecuencia")

# Gr√°fico de frecuencia relativa
p2 <- datos %>%
  count(smoking_status) %>%
  mutate(porcentaje = n / sum(n) * 100) %>%
  ggplot(aes(x = smoking_status, y = porcentaje)) +
  geom_col(fill = "darkorange") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 25)) +  # ROTACI√ìN del eje x
  geom_text(aes(label = paste0(round(porcentaje, 1), "%")), vjust = -0.5) +
  labs(title = "Frecuencia relativa smoking status", x = "Smoking Status", y = "Porcentaje")

# Mostrar ambos gr√°ficos lado a lado
p1 + p2

```

### Gr√°fico de barras agrupadas

Este gr√°fico permite comparar de forma directa la frecuencia de enfermedad card√≠aca en cada categor√≠a de fumador.

```{r}

ggplot(datos, aes(x = smoking_status, fill = factor(heart_disease))) +
  geom_bar(position = "dodge") +
  labs(title = "Smoking Status vs Heart Disease (Barras Agrupadas)", x = "Smoking Status", fill = "Heart Disease") +
  theme_minimal()

```

### Mapa de calor de una tabla de contingencia

Representaci√≥n visual de la frecuencia entre categor√≠as cruzadas de smoking_status y heart_disease.

```{r}
library(reshape2)

tabla <- table(datos$smoking_status, datos$heart_disease)
df_heat <- as.data.frame(tabla)
names(df_heat) <- c("smoking_status", "heart_disease", "frecuencia")

ggplot(df_heat, aes(x = heart_disease, y = smoking_status, fill = frecuencia)) +
  geom_tile() +
  geom_text(aes(label = frecuencia), color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "Heatmap: Smoking Status vs Heart Disease",
       x = "Heart Disease", y = "Smoking Status") +
  theme_minimal()
```

### Gr√°fico de pastel (pie chart)

Una visualizaci√≥n cl√°sica de distribuci√≥n proporcional para smoking_status.

```{r}

datos %>%
  count(smoking_status) %>%
  mutate(porcentaje = n / sum(n) * 100,
         label = paste0(smoking_status, ": ", round(porcentaje, 1), "%")) %>%
  ggplot(aes(x = "", y = porcentaje, fill = smoking_status)) +
  geom_col(width = 1) +
  coord_polar(theta = "y") +
  theme_void() +
  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +
  labs(title = "Distribuci√≥n de Smoking Status")

```

## Aplicaci√≥n interactiva

Como complemento a este cap√≠tulo, se ha desarrollado una aplicaci√≥n interactiva utilizando Shiny que permite explorar conceptos de estad√≠stica descriptiva y an√°lisis exploratorio con visualizaciones din√°micas y opciones personalizables para el usuario.

üîó **Accede a la app aqu√≠:**\
üëâ <https://deiversg.shinyapps.io/app_statistical_Methods/>

------------------------------------------------------------------------

üé• **Video tutorial ‚Äì ¬øC√≥mo usar la app?**

::: only-html
<iframe width="560" height="315" src="https://www.youtube.com/embed/TU_ID_DEL_VIDEO" title="Tutorial app estad√≠stica" frameborder="0" allowfullscreen>

</iframe>
:::

::: only-pdf
Video tutorial: [¬øC√≥mo usar la app?](https://www.youtube.com/watch?v=TU_ID_DEL_VIDEO)
:::

------------------------------------------------------------------------

## Recursos audiovisuales

### üé• Introducci√≥n a la estad√≠stica descriptiva

::: only-html
<iframe width="560" height="315" src="https://www.youtube.com/embed/W1_eCwuYkAI" title="Estad√≠stica descriptiva b√°sica" frameborder="0" allowfullscreen>

</iframe>
:::

::: only-pdf
Video: [Introducci√≥n a la estad√≠stica descriptiva](https://www.youtube.com/watch?v=W1_eCwuYkAI)
:::

------------------------------------------------------------------------

### üìä Visualizaci√≥n de datos en R (boxplots, histogramas)

::: only-html
<iframe width="560" height="315" src="https://www.youtube.com/embed/QyntPbbTOns" title="Visualizaci√≥n en R" frameborder="0" allowfullscreen>

</iframe>
:::

::: only-pdf
Video: [Visualizaci√≥n de datos en R](https://www.youtube.com/watch?v=QyntPbbTOns)
:::

------------------------------------------------------------------------

### üêç Exploraci√≥n con Python (Seaborn, pandas)

::: only-html
<iframe width="560" height="315" src="https://www.youtube.com/embed/ludqgCJe1aI" title="Python Exploratorio" frameborder="0" allowfullscreen>

</iframe>
:::

::: only-pdf
Video: [Exploraci√≥n con Python](https://www.youtube.com/watch?v=ludqgCJe1aI)
:::

------------------------------------------------------------------------

## Conclusi√≥n

El an√°lisis exploratorio de datos con herramientas como R y Python permite obtener una comprensi√≥n inicial robusta de los patrones en datos biom√©dicos. Esto es esencial antes de aplicar modelos predictivos como regresi√≥n o clasificaci√≥n. El uso de gr√°ficos y res√∫menes num√©ricos fortalece la interpretaci√≥n cl√≠nica y estad√≠stica de los fen√≥menos observados.
